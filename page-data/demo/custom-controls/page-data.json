{"componentChunkName":"component---src-templates-demo-jsx","path":"/demo/custom-controls","result":{"data":{"demoPage":{"html":"<p>This demo show how to start using the custom controls api.\nThis first example show how to write a custom render method for your control and how to define a custom action to run on the control mouseup.\nThe new api offers the ability to run custom actions on:</p>\n<ul>\n<li>mousedown</li>\n<li>mouseup</li>\n<li>mousemove</li>\n</ul>\n<p>And to run custom code for</p>\n<ul>\n<li>positioning</li>\n<li>rendering</li>\n<li>cursor style</li>\n</ul>\n<h2 id=\"creating-the-control\" style=\"position:relative;\">Creating the control<a href=\"#creating-the-control\" aria-label=\"creating the control permalink\" class=\"anchor after\"></a></h2>\n<p>We create a new control and we add it to the object.\nTo create a control we use <code class=\"language-javascript\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">fabric<span class=\"token punctuation\">.</span>Control</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span></code>\nIn this case we want the corner to be near the top right classic control, so we give it a position of x of 0.5 that is the extreme right of the bounding box of the object.\nSame for y at -0.5. We do not want it to overlap with the current top right corner, so we add an <code class=\"language-text\">offsetY</code> with a positive number that will make it render a bit more down.</p>\n<p>We want our control to render an icon rather than a fabric supported circle or square.\nSo we have to provide our own render function to the control.\nThe function is receiving the canvas context as first argument and so a simple drawImage will make it.</p>\n<p>For the custom action we want simply to delete the object.\nWe build a function following the mouseUpHandler signature and we use there <code class=\"language-javascript\">canvas<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span></code>;</p>\n<div\n  class=\"codepen-later\"\n  data-editable=\"true\"\n  data-height=\"500\"\n  data-default-tab=\"result\"\n  data-prefill='{\n    \"scripts\": \"https://unpkg.com/fabric@4.0.0-rc.1/dist/fabric.js\"\n  }'\n>\n<pre data-lang=\"css\" data-options-autoprefixer=\"true\">\n  .controls {\n  \tdisplay: inline-block;\n  }\n</pre>\n<pre data-lang=\"html\">\n  <div class=\"controls\">\n    <p>\n      <button id=\"add\" onclick=\"Add()\">Add a rectangle</button>\n    </p>\n  </div>\n  <canvas id=\"c\" width=\"400\" height=\"300\" style=\"border:1px solid #ccc\"></canvas>\n</pre>\n<pre data-lang=\"js\">\n\tvar canvas = this.__canvas = new fabric.Canvas('c');\n\t// create a rect object\n  var deleteIcon = \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E\";\n<p>  var img = document.createElement('img');\nimg.src = deleteIcon;</p>\n<p>  fabric.Object.prototype.transparentCorners = false;\nfabric.Object.prototype.cornerColor = 'blue';\nfabric.Object.prototype.cornerStyle = 'circle';</p>\n<p>  function Add() {\nvar rect = new fabric.Rect({\nleft: 100,\ntop: 50,\nfill: 'yellow',\nwidth: 200,\nheight: 100,\nobjectCaching: false,\nstroke: 'lightgreen',\nstrokeWidth: 4,\n});</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">canvas.add(rect);\ncanvas.setActiveObject(rect);</code></pre></div>\n<p>  }</p>\n<p>  fabric.Object.prototype.controls.deleteControl = new fabric.Control({\nx: 0.5,\ny: -0.5,\noffsetY: 16,\ncursorStyle: 'pointer',\nmouseUpHandler: deleteObject,\nrender: renderIcon,\ncornerSize: 24\n});</p>\n<p>  Add();</p>\n<p>  function deleteObject(eventData, target) {\nvar canvas = target.canvas;\ncanvas.remove(target);\ncanvas.requestRenderAll();\n}</p>\n<p>  function renderIcon(ctx, left, top, styleOverride, fabricObject) {\nvar size = this.cornerSize;\nctx.save();\nctx.translate(left, top);\nctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));\nctx.drawImage(img, -size/2, -size/2, size, size);\nctx.restore();\n}</p>\n</pre>\n</div>\n<h2 id=\"adding-a-clone-control\" style=\"position:relative;\">Adding a clone control<a href=\"#adding-a-clone-control\" aria-label=\"adding a clone control permalink\" class=\"anchor after\"></a></h2>\n<p>Let's add a new control to allow for quick duplication of the Object.\nWe use again <code class=\"language-javascript\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">fabric<span class=\"token punctuation\">.</span>Control</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span></code> and we add it to a key named <code class=\"language-text\">clone</code>.\nWhen the objects are shrunk too much, corners with offset do not look great, so in this case\nlet's try to keep them outside the bounding box, on the top.</p>\n<p>For the clone functionality we will simply do <code class=\"language-javascript\">target<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cloned</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>cloned<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></p>\n<div\n  class=\"codepen-later\"\n  data-editable=\"true\"\n  data-height=\"500\"\n  data-default-tab=\"result\"\n  data-prefill='{\n    \"scripts\": \"https://unpkg.com/fabric@4.0.0-beta.11/dist/fabric.js\"\n  }'\n>\n<pre data-lang=\"css\" data-options-autoprefixer=\"true\">\n  .controls {\n  \tdisplay: inline-block;\n  }\n</pre>\n<pre data-lang=\"html\">\n  <div class=\"controls\">\n    <p>\n      <button id=\"add\" onclick=\"Add()\">Add a rectangle</button>\n    </p>\n  </div>\n  <canvas id=\"c\" width=\"400\" height=\"300\" style=\"border:1px solid #ccc\"></canvas>\n</pre>\n<pre data-lang=\"js\">\n\tvar canvas = this.__canvas = new fabric.Canvas('c');\n\t// create a rect object\n  var deleteIcon = \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E\";\n<p>  var cloneIcon = \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='iso-8859-1'%3F%3E%3Csvg version='1.1' xmlns='<a href=\"http://www.w3.org/2000/svg\">http://www.w3.org/2000/svg</a>' xmlns:xlink='<a href=\"http://www.w3.org/1999/xlink\">http://www.w3.org/1999/xlink</a>' viewBox='0 0 55.699 55.699' width='100px' height='100px' xml:space='preserve'%3E%3Cpath style='fill:%23010002;' d='M51.51,18.001c-0.006-0.085-0.022-0.167-0.05-0.248c-0.012-0.034-0.02-0.067-0.035-0.1 c-0.049-0.106-0.109-0.206-0.194-0.291v-0.001l0,0c0,0-0.001-0.001-0.001-0.002L34.161,0.293c-0.086-0.087-0.188-0.148-0.295-0.197 c-0.027-0.013-0.057-0.02-0.086-0.03c-0.086-0.029-0.174-0.048-0.265-0.053C33.494,0.011,33.475,0,33.453,0H22.177 c-3.678,0-6.669,2.992-6.669,6.67v1.674h-4.663c-3.678,0-6.67,2.992-6.67,6.67V49.03c0,3.678,2.992,6.669,6.67,6.669h22.677 c3.677,0,6.669-2.991,6.669-6.669v-1.675h4.664c3.678,0,6.669-2.991,6.669-6.669V18.069C51.524,18.045,51.512,18.025,51.51,18.001z M34.454,3.414l13.655,13.655h-8.985c-2.575,0-4.67-2.095-4.67-4.67V3.414z M38.191,49.029c0,2.574-2.095,4.669-4.669,4.669H10.845 c-2.575,0-4.67-2.095-4.67-4.669V15.014c0-2.575,2.095-4.67,4.67-4.67h5.663h4.614v10.399c0,3.678,2.991,6.669,6.668,6.669h10.4 v18.942L38.191,49.029L38.191,49.029z M36.777,25.412h-8.986c-2.574,0-4.668-2.094-4.668-4.669v-8.985L36.777,25.412z M44.855,45.355h-4.664V26.412c0-0.023-0.012-0.044-0.014-0.067c-0.006-0.085-0.021-0.167-0.049-0.249 c-0.012-0.033-0.021-0.066-0.036-0.1c-0.048-0.105-0.109-0.205-0.194-0.29l0,0l0,0c0-0.001-0.001-0.002-0.001-0.002L22.829,8.637 c-0.087-0.086-0.188-0.147-0.295-0.196c-0.029-0.013-0.058-0.021-0.088-0.031c-0.086-0.03-0.172-0.048-0.263-0.053 c-0.021-0.002-0.04-0.013-0.062-0.013h-4.614V6.67c0-2.575,2.095-4.67,4.669-4.67h10.277v10.4c0,3.678,2.992,6.67,6.67,6.67h10.399 v21.616C49.524,43.26,47.429,45.355,44.855,45.355z'/%3E%3C/svg%3E%0A\"</p>\n<p>  var deleteImg = document.createElement('img');\ndeleteImg.src = deleteIcon;</p>\n<p>  var cloneImg = document.createElement('img');\ncloneImg.src = cloneIcon;</p>\n<p>  fabric.Object.prototype.transparentCorners = false;\nfabric.Object.prototype.cornerColor = 'blue';\nfabric.Object.prototype.cornerStyle = 'circle';</p>\n<p>  function Add() {\nvar rect = new fabric.Rect({\nleft: 100,\ntop: 50,\nfill: 'yellow',\nwidth: 200,\nheight: 100,\nobjectCaching: false,\nstroke: 'lightgreen',\nstrokeWidth: 4,\n});</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">canvas.add(rect);\ncanvas.setActiveObject(rect);</code></pre></div>\n<p>  }</p>\n<p>  function renderIcon(icon) {\nreturn function renderIcon(ctx, left, top, styleOverride, fabricObject) {\nvar size = this.cornerSize;\nctx.save();\nctx.translate(left, top);\nctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));\nctx.drawImage(icon, -size/2, -size/2, size, size);\nctx.restore();\n}\n}</p>\n<p>  fabric.Object.prototype.controls.deleteControl = new fabric.Control({\nx: 0.5,\ny: -0.5,\noffsetY: -16,\noffsetX: 16,\ncursorStyle: 'pointer',\nmouseUpHandler: deleteObject,\nrender: renderIcon(deleteImg),\ncornerSize: 24\n});</p>\n<p>  fabric.Object.prototype.controls.clone = new fabric.Control({\nx: -0.5,\ny: -0.5,\noffsetY: -16,\noffsetX: -16,\ncursorStyle: 'pointer',\nmouseUpHandler: cloneObject,\nrender: renderIcon(cloneImg),\ncornerSize: 24\n});</p>\n<p>  Add();</p>\n<p>  function deleteObject(eventData, target) {\nvar canvas = target.canvas;\ncanvas.remove(target);\ncanvas.requestRenderAll();\n}</p>\n<p>  function cloneObject(eventData, target) {\nvar canvas = target.canvas;\ntarget.clone(function(cloned) {\ncloned.left += 10;\ncloned.top += 10;\ncanvas.add(cloned);\n});\n}</p>\n</pre>\n</div>","frontmatter":{"title":"Custom controls"},"mdFile":{"__typename":"File","relativePath":"demo/custom-controls/index.md"}}},"pageContext":{"slug":"/demo/custom-controls","prev":{"title":"Copy and paste","slug":"/demo/copy-and-paste"},"next":{"title":"Custom controls for polygon","slug":"/demo/custom-controls-polygon"}}}}